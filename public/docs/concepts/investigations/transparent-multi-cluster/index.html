<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.104.1"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/kcp-dev.github.io/favicons/favicon.ico><link rel=apple-touch-icon href=/kcp-dev.github.io/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/kcp-dev.github.io/favicons/android-192x192.png sizes=192x192><title>Transparent multi-cluster | kcp – a Kubernetes-like multi-tenant control plane</title><meta name=description content="Investigation of transparent multi-cluster
"><meta property="og:title" content="Transparent multi-cluster"><meta property="og:description" content="Investigation of transparent multi-cluster
"><meta property="og:type" content="article"><meta property="og:url" content="http://avinal.space/kcp-dev.github.io/docs/concepts/investigations/transparent-multi-cluster/"><meta property="article:section" content="docs"><meta property="og:site_name" content="kcp – a Kubernetes-like multi-tenant control plane"><meta itemprop=name content="Transparent multi-cluster"><meta itemprop=description content="Investigation of transparent multi-cluster
"><meta itemprop=wordCount content="1113"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Transparent multi-cluster"><meta name=twitter:description content="Investigation of transparent multi-cluster
"><link rel=preload href=/kcp-dev.github.io/scss/main.min.c65bd9d7eb2baaad4d2c30a0905cadbf15f5bd43173d18c70d61a6eee706a020.css as=style><link href=/kcp-dev.github.io/scss/main.min.c65bd9d7eb2baaad4d2c30a0905cadbf15f5bd43173d18c70d61a6eee706a020.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-sm-row td-navbar"><a class="navbar-brand mr-2" style=display:flex;justify-content:center href=/kcp-dev.github.io/><img class=navbar-logo src=/logo.png width=38px alt=logo></a>
<a class=navbar-brand style=display:flex;justify-content:center href=/kcp-dev.github.io/><span class="font-weight-bold d-none d-sm-inline d-lg-none" style=font-size:.875rem>kcp</span>
<span class="font-weight-bold d-none d-lg-inline">kcp</span></a><div class="td-navbar-nav-scroll ml-sm-auto mt-0" id=main_navbar><ul class="navbar-nav mt-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/kcp-dev.github.io/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/kcp-dev/kcp/blob/main/CONTRIBUTING.md target=_blank><span>Contribute</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/kcp-dev/kcp/ target=_blank><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/kcp-dev.github.io/docs/><span class=active>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kcp-devgithubiodocs-li><a href=/kcp-dev.github.io/docs/ title="Welcome to kcp Documentation" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-kcp-devgithubiodocs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsgetting-started-li><a href=/kcp-dev.github.io/docs/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcp-devgithubiodocsgetting-started><span>Getting Started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kcp-devgithubiodocsconcepts-li><a href=/kcp-dev.github.io/docs/concepts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcp-devgithubiodocsconcepts><span>kcp Concepts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsauthorization-li><a href=/kcp-dev.github.io/docs/concepts/authorization/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsauthorization><span>Authorization</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptscache-server-li><a href=/kcp-dev.github.io/docs/concepts/cache-server/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptscache-server><span>Cache Server</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptscluster-mapper-li><a href=/kcp-dev.github.io/docs/concepts/cluster-mapper/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptscluster-mapper><span>Cluster Mapper</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptslocations-and-scheduling-li><a href=/kcp-dev.github.io/docs/concepts/locations-and-scheduling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptslocations-and-scheduling><span>Placement, Locations and Scheduling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptssyncer-li><a href=/kcp-dev.github.io/docs/concepts/syncer/ title="Registering Kubernetes Clusters using syncer" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptssyncer><span>Syncer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsquickstart-tenancy-and-apis-li><a href=/kcp-dev.github.io/docs/concepts/quickstart-tenancy-and-apis/ title="Quickstart: Tenancy and APIs" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsquickstart-tenancy-and-apis><span>Tenancy and APIs</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsconcepts-li><a href=/kcp-dev.github.io/docs/concepts/concepts/ title="Terminology for control plane" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsconcepts><span>Terminology</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsvirtual-workspaces-li><a href=/kcp-dev.github.io/docs/concepts/virtual-workspaces/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsvirtual-workspaces><span>Virtual Workspaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsworkspaces-li><a href=/kcp-dev.github.io/docs/concepts/workspaces/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsworkspaces><span>Workspaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kcp-devgithubiodocsconceptsdevelopers-li><a href=/kcp-dev.github.io/docs/concepts/developers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcp-devgithubiodocsconceptsdevelopers><span>Developers</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsdeveloperscontrollers-li><a href=/kcp-dev.github.io/docs/concepts/developers/controllers/ title="Writing kcp-aware controllers" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsdeveloperscontrollers><span>kcp-aware controllers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsdeveloperslibrary-usage-li><a href=/kcp-dev.github.io/docs/concepts/developers/library-usage/ title="Using `kcp` as a library" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsdeveloperslibrary-usage><span>Library Usage</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsdevelopersreleasing-li><a href=/kcp-dev.github.io/docs/concepts/developers/releasing/ title="Publishing a new kcp release" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsdevelopersreleasing><span>Publishing</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kcp-devgithubiodocsconceptsinvestigations-li><a href=/kcp-dev.github.io/docs/concepts/investigations/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcp-devgithubiodocsconceptsinvestigations><span>Investigations</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsinvestigationslogical-clusters-li><a href=/kcp-dev.github.io/docs/concepts/investigations/logical-clusters/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsinvestigationslogical-clusters><span>Logical clusters</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsinvestigationsminimal-api-server-li><a href=/kcp-dev.github.io/docs/concepts/investigations/minimal-api-server/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsinvestigationsminimal-api-server><span>Minimal API Server</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptsinvestigationsself-service-policy-li><a href=/kcp-dev.github.io/docs/concepts/investigations/self-service-policy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsinvestigationsself-service-policy><span>Self-service policy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-kcp-devgithubiodocsconceptsinvestigationstransparent-multi-cluster-li><a href=/kcp-dev.github.io/docs/concepts/investigations/transparent-multi-cluster/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptsinvestigationstransparent-multi-cluster><span class=td-sidebar-nav-active-item>Transparent multi-cluster</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocsconceptskubectl-kcp-plugin-li><a href=/kcp-dev.github.io/docs/concepts/kubectl-kcp-plugin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocsconceptskubectl-kcp-plugin><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kcp-devgithubiodocscli-reference-li><a href=/kcp-dev.github.io/docs/cli-reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcp-devgithubiodocscli-reference><span>CLI Reference</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp><span>kcp</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_crd-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_crd/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_crd><span>kcp crd</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_crd_snapshot-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_crd_snapshot/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_crd_snapshot><span>kcp crd snapshot</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workload-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workload/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workload><span>kcp workload</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workload_cordon-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workload_cordon/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workload_cordon><span>kcp workload cordon</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workload_drain-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workload_drain/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workload_drain><span>kcp workload drain</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workload_sync-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workload_sync/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workload_sync><span>kcp workload sync</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workload_uncordon-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workload_uncordon/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workload_uncordon><span>kcp workload uncordon</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workspace-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workspace/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workspace><span>kcp workspace</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workspace_create-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workspace_create/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workspace_create><span>kcp workspace create</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workspace_create-context-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workspace_create-context/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workspace_create-context><span>kcp workspace create-context</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workspace_current-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workspace_current/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workspace_current><span>kcp workspace current</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workspace_tree-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workspace_tree/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workspace_tree><span>kcp workspace tree</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscli-referencekcp_workspace_use-li><a href=/kcp-dev.github.io/docs/cli-reference/kcp_workspace_use/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-kcp-devgithubiodocscli-referencekcp_workspace_use><span>kcp workspace use</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kcp-devgithubiodocscrd-reference-li><a href=/kcp-dev.github.io/docs/crd-reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-kcp-devgithubiodocscrd-reference><span>CRD Reference</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/kcp-dev/kcp-dev.github.io/tree/main/docs/content/en/docs/Concepts/investigations/transparent-multi-cluster.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/kcp-dev/kcp-dev.github.io/edit/main/docs/content/en/docs/Concepts/investigations/transparent-multi-cluster.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/kcp-dev/kcp-dev.github.io/new/main/docs/content/en/docs/Concepts/investigations/transparent-multi-cluster.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/kcp-dev/kcp-dev.github.io/issues/new?title=Transparent%20multi-cluster" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/kcp-dev/kcp/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#goal-the-majority-of-applications-and-teams-should-have-workflows-where-cluster-is-a-detail>Goal: The majority of applications and teams should have workflows where cluster is a detail</a><ul><li><a href=#constraint-the-workflows-and-practices-teams-use-today-should-be-minimally-disrupted>Constraint: The workflows and practices teams use today should be minimally disrupted</a></li><li><a href=#constraint-95-of-workloads-should-just-work-when-kubectl-applyd-to-kcp>Constraint: 95% of workloads should &ldquo;just work&rdquo; when <code>kubectl apply</code>d to <code>kcp</code></a></li><li><a href=#constraint-90-of-application-infrastructure-controllers-should-be-useful-against-kcp>Constraint: 90% of application infrastructure controllers should be useful against <code>kcp</code></a></li></ul></li><li><a href=#areas-of-investigation>Areas of investigation</a></li><li><a href=#use-cases>Use cases</a><ul><li><a href=#as-a-user>As a user</a></li><li><a href=#as-an-infrastructure-admin>As an infrastructure admin</a></li></ul></li><li><a href=#progress>Progress</a><ul><li><a href=#possible-design-simplifications>Possible design simplifications</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=http://avinal.space/kcp-dev.github.io/docs/>Documentation</a></li><li class=breadcrumb-item><a href=http://avinal.space/kcp-dev.github.io/docs/concepts/>kcp Concepts</a></li><li class=breadcrumb-item><a href=http://avinal.space/kcp-dev.github.io/docs/concepts/investigations/>Investigations</a></li><li class="breadcrumb-item active" aria-current=page><a href=http://avinal.space/kcp-dev.github.io/docs/concepts/investigations/transparent-multi-cluster/ aria-disabled=true class="btn-link disabled">Transparent multi-cluster</a></li></ol></nav><div class=td-content><h1>Transparent multi-cluster</h1><div class=lead>Investigation of transparent multi-cluster</div><header class=article-meta></header><p>A key tenet of Kubernetes is that workload placement is node-agnostic until the user needs it to be - Kube offers a homogeneous compute surface that admins or app devs can &ldquo;break-glass&rdquo; and set constraints all the way down to writing software that deeply integrates with nodes. But for the majority of workloads a cluster is no more important than a node - it&rsquo;s a detail determined by some human or automated process.</p><p>A key area of investigation for <code>kcp</code> is exploring transparency of workloads to clusters. Aspirationally we want Kube workloads to be resilient to the operational characteristics of the underlying infrastructure and clusters orthogonally to the workload, by isolating the user from knowing of the details of the infrastructure. If workload APIs are more consistently &ldquo;node-less&rdquo; and &ldquo;cluster-agnostic&rdquo; that opens up ways to drive workload consistency across a large swathe of the compute landscape.</p><h2 id=goal-the-majority-of-applications-and-teams-should-have-workflows-where-cluster-is-a-detail>Goal: The majority of applications and teams should have workflows where cluster is a detail</h2><p>A number of projects have explored this since the beginning of Kubernetes - this prototype should explore in detail how we can make a normal Kubernetes flow for most users be cluster-independent but still &ldquo;break-glass&rdquo; and describe placement in detail. Since this is a broad topic and we want to benefit the majority of users, we need to also add constraints that maximize the chance of these approaches being adopted.</p><h3 id=constraint-the-workflows-and-practices-teams-use-today-should-be-minimally-disrupted>Constraint: The workflows and practices teams use today should be minimally disrupted</h3><p>Users typically only change their workflows when an improvement offers a significant multiplier. To be effective we must reduce friction (which reduces multipliers) and offer significant advantages to that workflow.</p><p>Tools, practices, user experiences, and automation should &ldquo;just work&rdquo; when applied to cluster-agnostic or cluster-aware workloads. This includes gitops, rich web interfaces, <code>kubectl</code>, etc. That implies that a &ldquo;cluster&rdquo; and a &ldquo;Kube API&rdquo; is our key target, and that we must preserve a majority of semantic meaning of existing APIs.</p><h3 id=constraint-95-of-workloads-should-just-work-when-kubectl-applyd-to-kcp>Constraint: 95% of workloads should &ldquo;just work&rdquo; when <code>kubectl apply</code>d to <code>kcp</code></h3><p>It continues to be possible to build different abstractions on top of Kube, but existing workloads are what really benefit users. They have chosen the Kube abstractions deliberately because they are general purpose - rather than describe a completely new system we believe it is more effective to uplevel these existing apps. That means that existing primitives like Service, Deployment, PersistentVolumeClaim, StatefulSet must all require no changes to move from single-cluster to multi-cluster</p><p>By choosing this constraint, we also accept that we will have to be opinionated on making the underlying clusters consistent, and we will have to limit / constrain certain behaviors. Ideally, we focus on preserving the user&rsquo;s view of the changes on a logical cluster, while making the workloads on a physical cluster look more consistent for infrastructure admins. This implies we need to explore both what these workloads might look like (a review of applications) and describe the points of control / abstraction between levels.</p><h3 id=constraint-90-of-application-infrastructure-controllers-should-be-useful-against-kcp>Constraint: 90% of application infrastructure controllers should be useful against <code>kcp</code></h3><p>A controller that performs app infra related functions should be useful without change against <code>kcp</code>. For instance, the etcd operator takes an <code>Etcd</code> cluster CRD and creates pods. It should be possible for that controller to target a <code>kcp</code> logical cluster with the CRD and create pods on the logical cluster that are transparently placed onto a cluster.</p><h2 id=areas-of-investigation>Areas of investigation</h2><ol><li>Define high level user use cases</li><li>Study approaches from the ecosystem that do not require workloads to change significantly to spread</li><li>Explore characteristics of most common Kube workload objects that could allow them to be transparently placed</li><li>Identify the control points and data flow between workload and physical cluster that would be generally useful across a wide range of approaches - such as:<ol><li>How placement is assigned, altered, and removed (&ldquo;scheduling&rdquo; or &ldquo;placement&rdquo;)</li><li>How workloads are transformed from high level to low level and then summarized back</li><li>Categorize approaches in the ecosystem and gaps where collaboration could improve velocity</li><li></li></ol></li><li>Identify key infrastructure characteristics for multi-cluster<ol><li>Networking between components and transparency of location to movement</li><li>Data movement, placement, and replication</li><li>Abstraction/interception of off-cluster dependencies (external to the system)</li><li>Consistency of infrastructure (where does Kube not sufficiently drive operational consistency)</li></ol></li><li>Seek consensus in user communities on whether the abstractions are practical</li><li>Invest in key technologies in the appropriate projects</li><li>Formalize parts of the prototype into project(s) drawing on the elements above if successful!</li></ol><h2 id=use-cases>Use cases</h2><p>Representing feedback from a number of multi-cluster users with a diverse set of technologies in play:</p><h3 id=as-a-user>As a user</h3><ol><li>I can <code>kubectl apply</code> a workload that is agnostic to node placement to <code>kcp</code> and see the workload assigned to real resources and start running and the status summarized back to me.</li><li>I can move an application (defined in 1) between two physical clusters by changing a single high level attribute</li><li>As a user when I move an application (as defined in 2) no disruption of internal or external traffic is visible to my consumers</li><li>As a user I can debug my application in a familiar manner regardless of cluster</li><li>As a user with a stateful application by persistent volumes can move / replicate / be shared across clusters in a manner consistent with my storage type (read-write-one / read-write-many).</li></ol><h3 id=as-an-infrastructure-admin>As an infrastructure admin</h3><ol><li>I can decommision an physical cluster and see workloads moved without disruption</li><li>I can set capacity bounds that control admission to a particular cluster and react to workload growth organically</li></ol><h2 id=progress>Progress</h2><p>In the early prototype stage <code>kcp</code> uses the <code>syncer</code> and the <code>deployment-splitter</code> as stand-ins for more complex scheduling and transformation. This section should see more updates in the near term as we move beyond areas 1-2 (use cases and ecosystem research)</p><h3 id=possible-design-simplifications>Possible design simplifications</h3><ol><li>Focus on every object having an annotation saying which clusters it is targeted at<ul><li>We can control the annotation via admission eventually, works for all objects</li><li>Tracking declarative and atomic state change (NONE -> A, A->(A,B), A->NONE) on
objects</li></ul></li><li>RBAC stays at the higher level and applies to the logical clusters, is not synced<ul><li>Implication is that controllers won&rsquo;t be syncable today, BUT that&rsquo;s ok because it&rsquo;s likely giving workloads control over the underlying cluster is a non-goal to start and would have to be explicit opt-in by admin</li><li>Controllers already need to separate input from output - most controllers assume they&rsquo;re the same (but things like service load balancer)</li></ul></li><li>Think of scheduling as a policy at global, per logical cluster, and optionally the namespace (policy of object type -> 0..N clusters)<ul><li>Simplification over doing a bunch of per object work, since we want to be transparent (per object is a future optimization with some limits)</li></ul></li></ol></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/kcp-users aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/kcp aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/kcp-dev/kcp aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://kubernetes.slack.com/archives/C021U8WSAFK aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/kcp-dev aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 The kcp Authors All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/kcp-dev.github.io/js/main.min.ab5782f4ac34d02d9c5eb3ff3f8fe491f646a255a3f2a6121c80c7416e763f5e.js integrity="sha256-q1eC9Kw00C2cXrP/P4/kkfZGolWj8qYSHIDHQW52P14=" crossorigin=anonymous></script></body></html>